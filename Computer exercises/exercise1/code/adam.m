

function [u1, u2] = adam(u1, u2, h, n)
    
    my = 1/82.45;
    r0 = [-my, 0]';
    r1 = [1-my, 0]';
    N = [0, 1; -1 0];
    uvec = @(u1,u2) [u2, (-(1-my)*((u1-r0)./(vecnorm(u1-r0).^3))) - (my*((u1-r1)./(vecnorm(u1-r1).^3))) + (2*N*u2) + u1];


    f1 = uvec(u1(:,n), u2(:,n));
    f2 = uvec(u1(:,n-1), u2(:,n-1));
    f3 = uvec(u1(:,n-2), u2(:,n-2));
    f4 = uvec(u1(:,n-3), u2(:,n-3));

    u1(:,n+1) = u1(:,n) + (h/24)*(55*f1(:,1) - 59*f2(:,1) + 37*f3(:,1) - 9*f4(:,1));
    u2(:,n+1) = u2(:,n) + (h/24)*(55*f1(:,2) - 59*f2(:,2) + 37*f3(:,2) - 9*f4(:,2));
end

